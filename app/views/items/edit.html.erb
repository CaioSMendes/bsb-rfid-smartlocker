<p class="text-success"><%= notice %></p>

<div id="page-wrapper">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12">
        <ol class="breadcrumb">
          <li class="active">
            <h1><i class="fas fa-warehouse"></i> Meus Ativos</h1>
          </li>
        </ol>
      </div>
    </div>
  </div>
</div>

<%= form_with(model: [@asset_management, @item]) do |form| %>
  <% if @item.errors.any? %>
    <div class="alert alert-danger">
      <h5><%= pluralize(@item.errors.count, "erro") %> impediram o item de ser salvo:</h5>
      <ul>
        <% @item.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-8 mb-4">
      <div class="card shadow-sm">
        <div class="card-header py-3">
          <h5 class="mb-0"><i class="fa fa-box me-2"></i> Editar um ativo</h5>
        </div>
        <div class="card-body">

          <!-- Nome do Ativo -->
          <div class="form-outline mb-4">
            <%= form.label :name, 'Nome do Ativo', class: "form-label" %>
            <%= form.text_field :name, class: 'form-control' %>
          </div>

          <!-- Tag RFID -->
          <div class="form-outline mb-4">
            <%= form.label :tagRFID, 'Tag RFID', class: "form-label" %>
            <%= form.text_field :tagRFID, class: 'form-control' %>
          </div>

          <!-- ID Interno -->
          <div class="form-outline mb-4">
            <%= form.label :idInterno, 'ID Interno', class: "form-label" %>
            <%= form.text_field :idInterno, class: 'form-control' %>
          </div>

           <!-- Qtd Dígito -->
            <div class="form-outline mb-4">
              <%= form.label :qtdDigito, 'Quantidade de Dígitos', class: "form-label" %>
              <%= form.number_field :qtdDigito, class: 'form-control' %>
            </div>
            
          <!-- Descrição -->
          <div class="form-outline mb-4">
            <%= form.label :description, 'Descrição', class: "form-label" %>
            <%= form.text_field :description, class: 'form-control' %>
          </div>

          <!-- Status -->
          <div class="form-outline mb-4">
            <%= form.label :status, class: "form-label d-flex align-items-center" do %>
              <i class="fa fa-toggle-on me-2"></i> Status do Ativo
            <% end %>
            <%= form.select :status, [['Ativo', 'Ativo'], ['Inativo', 'Inativo']], {}, class: 'form-control' %>
          </div>

          <!-- Vazio -->
          <%= form.hidden_field :empty %>

            <!-- Categoria -->
            <div class="form-outline mb-4">
              <%= form.label :category_id, class: "form-label" do %>
                <i class="fa fa-list me-1"></i> Categoria
              <% end %>

              <%= form.select :category_id, options_for_select(@categories.map { |c| [c.name, c.id] }),
                    { prompt: "Escolha categoria" },
                    { class: "form-control", id: "category_select" } %>
            </div>

            <!-- Categoria -->
            <div class="form-outline mb-4">
              <%= form.label :category_name, class: "form-label" do %>
                <i class="fa fa-list me-1"></i> Categoria
              <% end %>

              <%= form.text_field :category_name, id: "category_input", class: "form-control", placeholder: "Digite a categoria" %>
            </div>

          <!-- Localização -->
          <div class="form-outline mb-4">
            <%= form.label :location_id, class: "form-label" do %>
              <i class="fa fa-map-marker-alt me-1"></i> Localização
            <% end %>
            <%= form.collection_select :location_id, 
                  @asset_management.locations, 
                  :id, :name, 
                  { prompt: "Escolha a localização" }, 
                  { class: "form-select" } %>
          </div>

          <!-- Upload da Imagem -->
          <div class="form-outline mb-4">
            <%= form.label :image, "Imagem do Ativo", class: "form-label" %>
            <%= form.file_field :image, class: "form-control" %>
          </div>

          <!-- Botões -->
          <div class="d-flex justify-content-between mt-4">
            <%= form.submit 'Editar Ativo', class: 'btn btn-primary' %>
          </div>

        </div>
      </div>
    </div>
  </div>
<% end %>
</div>


<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

<script>
$(document).ready(function() {
  var availableCategories = <%= raw(@categories.pluck(:name).to_json) %>;

  $("#category_input").autocomplete({
    source: availableCategories,
    minLength: 0
  }).focus(function(){
    $(this).autocomplete("search", "");
  });
});
</script>